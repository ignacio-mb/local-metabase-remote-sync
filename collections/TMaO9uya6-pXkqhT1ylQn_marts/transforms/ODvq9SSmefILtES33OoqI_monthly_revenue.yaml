collection_id: TMaO9uya6-pXkqhT1ylQn
created_at: '2026-02-18T12:02:51.782312Z'
creator_id: api-key-user-9a385425-e591-4b84-b39f-6c4040997f61@api-key.invalid
description: |-
  Monthly revenue aggregation for reporting dashboards
  Migrated from dbt model: model.shop_analytics.monthly_revenue
  Source: models/marts/monthly_revenue.sql
  Dependencies: fct_orders
entity_id: ODvq9SSmefILtES33OoqI
name: monthly_revenue
owner_email: null
owner_user_id: api-key-user-9a385425-e591-4b84-b39f-6c4040997f61@api-key.invalid
source:
  query:
    database: Analytics (dbt)
    native:
      query: |-
        WITH orders AS (
            SELECT * FROM transforms_marts.fct_orders
            WHERE order_status = 'completed'
        )

        SELECT
            DATE_TRUNC('month', order_date)::date AS month,
            COUNT(order_id)                       AS total_orders,
            COUNT(DISTINCT customer_id)           AS unique_customers,
            SUM(order_total)                      AS gross_revenue,
            SUM(amount_paid)                      AS collected_revenue,
            AVG(order_total)                      AS avg_order_value,
            SUM(total_quantity)                   AS items_sold
        FROM orders
        GROUP BY DATE_TRUNC('month', order_date)
        ORDER BY month
    type: native
  type: query
source_database_id: Analytics (dbt)
tags: []
target:
  database: Analytics (dbt)
  name: monthly_revenue
  schema: transforms_marts
  type: table
serdes/meta:
- id: ODvq9SSmefILtES33OoqI
  label: monthly_revenue
  model: Transform
